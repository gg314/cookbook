% Compile with LuaLaTeX

\documentclass[sans-serif,landscape,11pt,openany]{book}

\def\mytitle{Cookbook}
\def\myauthor{Rachel \& Graham}
\def\mykeywords{cookbook, food}


\usepackage{multicol}
\usepackage[no-math]{fontspec}
\usepackage[empty]{fullpage}
\usepackage{tabularx}
\usepackage[explicit]{titlesec} % to do: use..
\usepackage{graphicx}
\usepackage[tmargin=1.0in, rmargin=1.0in, bmargin=1.25in, lmargin=1.0in, footskip=0.375in, paperwidth=8.5in, paperheight=11.0in]{geometry}
\usepackage{titlesec}
\usepackage{xfrac}
\usepackage[colorlinks,hidelinks,breaklinks=true,linkcolor={[rgb]{0.0,0.0,0.0}},urlcolor={[rgb]{0.15,0.42,0.63}},unicode,plainpages=false,pdfpagelabels,pdftitle={\mytitle},pdfauthor={\myauthor},pdfkeywords={\mykeywords}]{hyperref}
\usepackage{fancyhdr}
\usepackage{gensymb} % \degree, \celsius
\usepackage[usenames,dvipsnames]{color}
\usepackage[framemethod=TikZ]{mdframed} % colored boxes
\usepackage{fontawesome}
\usepackage{setspace}
\usepackage{tocloft}

\usepackage{cookbook}  % custom style

% Adjust margins
\addtolength{\oddsidemargin}{-0.0in}
\addtolength{\evensidemargin}{-0.0in}
\addtolength{\textwidth}{0.0in} % oddsidemargin + evensidemargin
\addtolength{\topmargin}{-.00in}
\addtolength{\textheight}{0.00in}

\urlstyle{same}


\newfontfamily\chapterlabelfont[Color=b89286]{BrandonPrinted-One}
\newfontfamily\brandonfont[Color=9c3a19]{BrandonPrinted-One}
\newfontfamily\brandonshadowfont[Color=9c3a19]{BrandonPrinted-OneShadow}
\newfontfamily\dinlightfont[Color=606060]{DINPro-Light}
\newfontfamily\dinfont[Color=303030]{DINPro}
\newfontfamily\slabfont[Color=9c3a19]{NexaSlab-xBold}
\newfontfamily\seriffont[Ligatures={TeX,Common},BoldFont={PalatinoLTStd-Bold},ItalicFont={PalatinoLTStd-Italic}]{PalatinoLTStd}
\setmainfont[Ligatures={TeX,Common},BoldFont={DINPro-Bold},ItalicFont={DINPro-Italic}]{DINPro}
\setsansfont[Ligatures={TeX,Common},BoldFont={DINPro-Bold},ItalicFont={DINPro-Italic}]{DINPro}
% luaotfload-tool -uvvvv >fontdbupdates.log
% luaotfload-tool --list=format


\fancypagestyle{plain}
\fancyhf{} % clear all header and footer fields
\fancyfoot[CE,CO]{} % \leftmark
\fancyfoot[RO]{{\small\dinlightfont\leftmark}~{\small\dinfont\thepage}}
\fancyfoot[LE]{{\small\dinfont\thepage}~{\small\dinlightfont\leftmark}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\pagestyle{fancy}
\fancyhf{} % clear all header and footer fields
\fancyfoot[CE,CO]{} % \leftmark
\fancyfoot[RO]{{\small\dinlightfont\leftmark}~{\small\dinfont\thepage}}
\fancyfoot[LE]{{\small\dinfont\thepage}~{\small\dinlightfont\leftmark}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% background. can't be removed, don't remember why
\usepackage{background}
\usetikzlibrary{calc}
\SetBgScale{1}
\SetBgAngle{0}
\SetBgOpacity{1}
\SetBgContents{}

% auxiliary counter
\newcounter{chapshift}
\addtocounter{chapshift}{-1}

\newcommand\header[1]{{\slabfont{\fauxsc{#1}}}}
\newcommand\smallheader[1]{\textbf{\footnotesize{\MakeUppercase{#1}}}}


% chapter tabs on each page; the mandatory argument sets the color of the vertical box
\usepackage{ifthen}
% the list of colors to be used (add more if needed)
\newcommand\BoxColor{%
	\ifcase\thechapshift red!10\or orange!10\or olive!10\or teal!15\or blue!12\or magenta!10\or black!10\or green!10\or yellow!20\or red!10\or orange!10\else olive!10\fi}
\makeatletter
\newcommand\ChapFrame{%
	\AddEverypageHook{%
		\ifthenelse{\isodd{\thepage}}
		{\SetBgContents{%
				\begin{tikzpicture}[overlay,remember picture]
				\node[fill=\BoxColor,inner sep=0pt,rectangle,text width=0.9cm,
				text height=4cm,align=center,anchor=north east]
				at ($ (current page.north east) + (-0cm,-2*\thechapshift cm) $)
				{\rotatebox{90}{\hspace*{.3cm}\parbox[c][0.3cm][t]{3.4cm}{%
							\raggedright\textcolor{black}{\dinfont\leftmark}}}};
				\end{tikzpicture}}%
		}
		{\SetBgContents{%
				\begin{tikzpicture}[overlay,remember picture]
				\node[fill=\BoxColor,inner sep=0pt,rectangle,text width=0.9cm,
				text height=4cm,align=center,anchor=north west]
				at ($ (current page.north west) + (-0cm,-2*\thechapshift cm) $)
				{\rotatebox{90}{\hspace*{.3cm}\parbox[c][0.3cm][t]{3.4cm}{%
							\raggedright\textcolor{black}{\dinfont\leftmark}}}};
				\end{tikzpicture}}
		}
		\bg@material}%
	\stepcounter{chapshift}
}
\makeatother

% redefinition of \chaptermark to contain only the title
\renewcommand\chaptermark[1]{\markboth{#1}{}}




\makeatletter
\let\@chapterimage\relax
\newcommand\chapterimage[1]{%
	\if\relax\detokenize{#1}\relax
	\else
	\gdef\@chapterimage{
		\begin{center}
			\includegraphics[width=5in,height=5in,keepaspectratio]{#1}
			\vspace{0.5in}
		\end{center}
	}
	\fi
}

%\titleformat{\chapter}[display]{\Huge\chapterlabelfont}{\chaptertitlename~\thechapter\filcenter}{0pt}{\brandonshadowfont\fontsize{46}{54}\selectfont\filcenter}{}

\titleformat{\chapter}[display]
{\Huge\chapterlabelfont}
{
	{\@chapterimage}
	\chaptertitlename~\thechapter\filcenter
}
{0pt}
{
	\brandonshadowfont\fontsize{46}{54}\selectfont\filcenter#1
}

\newcommand\nochapterimage{
	\let\@chapterimage\relax
}
\makeatother


\renewcommand{\thesection}{}  % don't show the section numbers
\titleformat{\section}[block]{\brandonfont\fontsize{26}{36}\selectfont#1\filcenter}{}{0em}{}[\vspace{10pt}]
\titleformat{\subsection}[block]{\scshape\large#1\filcenter}{}{0em}{}[\titlerule]
\setlength{\parindent}{0em}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\renewcommand\cup{c.~}
\newcommand\cups{\cup}

\newcommand\lb{lb.~}
\newcommand\lbs{\lb}

\renewcommand\t{t.~}
\newcommand\tsp{\t}

\newcommand\T{T.~}
\newcommand\Tbsp{\T}
\newcommand\tbsp{\T}

\newcommand\oz{oz.~}
\newcommand\ounce{\oz}
\newcommand\ounces{\oz}

\newcommand\qt{qt.~}
\newcommand\quart{\qt}
\newcommand\quarts{\qt}


\begin{document}
	\sffamily

	\setlength{\parskip}{.75em}

	\setlength{\columnseprule}{0pt}
	\setlength{\columnsep}{0.7cm}
	\setcounter{tocdepth}{1}
	\begin{multicols}{2}
		{\sffamily\tableofcontents}
	\end{multicols}
	\setlength{\columnseprule}{0.4pt}
	\setlength{\columnsep}{1.5cm}


	\chapterimage{drawings/appetizers.png}
	\chapter{Appetizers}\ChapFrame\newpage
	\include{appetizers/goat_cheese_stuffed_peppers}
	\include{appetizers/salami_and_gruyere_gougeres}
	\include{appetizers/zaatar_spiced_beet_dip}
	\include{appetizers/samosadillas}

	\chapterimage{drawings/breads.png}
	\chapter{Breads}\ChapFrame\newpage
	\include{breads/blueberry_scones}
	\include{breads/apple_scones}
	\include{breads/green_chile_cheese_biscuits}
	\include{breads/zucchini_bread}
	\include{breads/one_hour_rolls}
	\include{breads/homemade_thin-crust_pizza}

	\chapterimage{drawings/salads.png}
	\chapter{Salads}\ChapFrame\newpage
	\input{salads/thai_peanut_quinoa_salad}
	\input{salads/potato_and_arugula_salad}

	\chapterimage{drawings/soups.png}
	\chapter{Soups}\ChapFrame\newpage
	\input{soups/cauliflower_turmeric_soup}
	\input{soups/carrot-tahini_soup}
	\input{soups/beer_cheese_soup}
	\input{slowcooker/potato_kielbasa_soup}

	\chapterimage{drawings/side-dishes.png}
	\chapter{Side Dishes}\ChapFrame\newpage
	\input{sides/creamy_mashed_potatoes}
	\input{sides/spicy_asian_brussel_sprouts}
	\input{sides/cilantro_lime_rice}


	\chapterimage{drawings/entrees.png}
	\chapter{Entrees}\ChapFrame\newpage
	\input{entrees/pork_scaloppine}
	\input{entrees/lime_cilantro_chicken_fajitas}
	\input{entrees/cheesy_lentils_beans_and_rice}
	\input{entrees/baked_ziti}
	\input{entrees/lasagna}
	\input{entrees/pasta_aglio_e_olio}
	\input{entrees/hotdish}
	% hasselback kielbasa & sausages w/ potatoes and red cabbage

	\chapterimage{drawings/slow-cooker.png}
	\chapter{Slow Cooker}\ChapFrame\newpage
	\input{slowcooker/honey_soy_chicken}
	\input{slowcooker/mississippi_roast}
	\input{slowcooker/mongolian_beef}
	\input{slowcooker/beef_stew}
	\input{slowcooker/tuscan_chicken}
	\input{slowcooker/butter_chicken}
	\input{slowcooker/tortellini_spinach_chicken_soup}
	\input{slowcooker/pulled_pork}
	% apple butter, plum butter

	\chapterimage{drawings/breakfast.png}
	\chapter{Breakfast}\ChapFrame\newpage
	\input{breakfast/orange_ricotta_pancakes}
	\input{breakfast/bombay_breakfast_potatoes}


	\chapterimage{drawings/desserts.png}
	\chapter{Desserts}\ChapFrame\newpage
	\input{desserts/coffee_spice_cookies}
	\input{desserts/apple_butterscotch_cookies}
	\input{desserts/vegan_pumpkin_cookies}
	\input{desserts/pumpkin_maple_muffins}
	\input{desserts/guava_cream_cheese_pop_tarts}
	\input{desserts/rosemary_shortbread_cookies}

	% chocolate chip cookies

	\chapterimage{drawings/cocktails.png}
	\chapter{Cocktails}\ChapFrame\newpage
	\input{cocktails/sparkling_elderflower}
	\input{cocktails/trinidad_sour}



\end{document}